<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Meus Links √öteis - linkWorkH 1.3</title>
<link rel="stylesheet" href="styles.css">
</head>
<body data-theme="light">

<!-- Bot√£o para alternar tema -->
<button id="theme-toggle" aria-label="Alternar Tema">üåô</button>

<div class="container">
    <h1>üîó Meus Links √öteis</h1>
    <div id="loading" class="loading">Carregando seus links...</div>
    <div class="links-container" id="links"></div>

    <!-- Formul√°rio para adicionar -->
    <div class="form-container">
        <h2>‚ûï Adicionar Novo Link</h2>
        <form id="form">
            <input type="text" id="link" placeholder="URL" required>
            <input type="text" id="linkName" placeholder="Nome" required>
            <select id="color">
                <option value="blue">Azul</option>
                <option value="green">Verde</option>
                <option value="orange">Laranja</option>
                <option value="purple">Roxo</option>
            </select>
            <button type="submit" class="btn">Adicionar</button>
        </form>
    </div>

    <!-- Formul√°rio para excluir -->
    <div class="form-container">
        <h2>üóëÔ∏è Gerenciar Links</h2>
        <form id="delete-form">
            <select id="delete-select">
                <option value="-1">Selecione um link para excluir</option>
            </select>
            <button type="submit" class="btn btn-danger">Excluir</button>
        </form>
    </div>
</div>

<footer class="footer">
    &copy; 2024 - Helio Goes Junior - Todos os direitos reservados
</footer>

<script type="module">
// Firebase j√° configurado no seu linkWorkH 1.2
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, push, set, remove, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
    apiKey: "AIzaSyCHimH-hvDo2uedCijx8LKXMY_Z8fkLJS0",
    authDomain: "appsworksh.firebaseapp.com",
    databaseURL: "https://appsworksh-default-rtdb.firebaseio.com",
    projectId: "appsworksh",
    storageBucket: "appsworksh.appspot.com",
    messagingSenderId: "910353044495",
    appId: "1:910353044495:web:b82a2c3d0a69dcfd663f7a",
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const linksRef = ref(db, 'links');
let linksData = [];

// Tema
const toggleBtn = document.getElementById('theme-toggle');
const savedTheme = localStorage.getItem('theme');
if (savedTheme) {
    document.body.dataset.theme = savedTheme;
    toggleBtn.textContent = savedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
}
toggleBtn.addEventListener('click', () => {
    const newTheme = document.body.dataset.theme === 'light' ? 'dark' : 'light';
    document.body.dataset.theme = newTheme;
    toggleBtn.textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
    localStorage.setItem('theme', newTheme);
});

// CRUD
function loadLinks() {
    const loading = document.getElementById('loading');
    onValue(linksRef, (snapshot) => {
        const data = snapshot.val();
        const linksDiv = document.getElementById('links');
        linksDiv.innerHTML = '';
        linksData = [];
        if (data) {
            Object.entries(data).forEach(([id, val]) => {
                linksData.push({id, ...val});
                const btn = document.createElement('a');
                btn.href = val.url;
                btn.textContent = val.name;
                btn.className = `button button-${val.color}`;
                btn.target = '_blank';
                linksDiv.appendChild(btn);
            });
        }
        updateDeleteOptions();
        loading.style.display = 'none';
    });
}

function addLink(url, name, color) {
    const newRef = push(linksRef);
    set(newRef, {url, name, color, timestamp: Date.now()});
}

function deleteLink(id) {
    remove(ref(db, `links/${id}`));
}

function updateDeleteOptions() {
    const sel = document.getElementById('delete-select');
    sel.innerHTML = '<option value="-1">Selecione um link para excluir</option>';
    linksData.forEach((l, i) => {
        const opt = document.createElement('option');
        opt.value = i;
        opt.text = l.name;
        sel.appendChild(opt);
    });
}

document.getElementById('form').addEventListener('submit', e => {
    e.preventDefault();
    const url = document.getElementById('link').value;
    const name = document.getElementById('linkName').value;
    const color = document.getElementById('color').value;
    addLink(url, name, color);
    e.target.reset();
});

document.getElementById('delete-form').addEventListener('submit', e => {
    e.preventDefault();
    const idx = document.getElementById('delete-select').value;
    if (idx !== "-1") {
        deleteLink(linksData[idx].id);
    }
});

loadLinks();
</script>
</body>
</html>